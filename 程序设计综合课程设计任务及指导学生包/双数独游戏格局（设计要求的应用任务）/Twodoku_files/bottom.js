var textarea,content,isVivibleScrollButton=!1,scrollButtonLim=700,lastPushMes="",watchList={};function ToggleMenu(e){1==(e=void 0===e?"none"==jQuery("#left_panel").css("display")?1:0:e)?(jQuery("#left_panel").show(100),jQuery(document).width(),RememberFlag(0,"hdl")):(jQuery("#left_panel").hide(100),jQuery("body").hasClass("pzdispl")||RememberFlag(1,"hdl")),jQuery("body").hasClass("pzdispl")||setTimeout(function(){$(window).resize()},200)}function ToggleRBlock(e,t){1==(e=void 0===e?"none"==jQuery("#right_panel").css("display")?1:0:e)?(jQuery("#right_panel").show(100),void 0===t&&RememberFlag(0,"hdr")):jQuery("#right_panel").hide(100),jQuery("body").hasClass("pzdispl")||setTimeout(function(){$(window).resize()},200)}function TouchDist(e){var t=e.originalEvent.touches[0].clientX,o=e.originalEvent.touches[0].clientY,a=e.originalEvent.touches[1].clientX,e=e.originalEvent.touches[1].clientY;return Math.sqrt((t-a)*(t-a)+(o-e)*(o-e))}function IsTouchZoom(e){if(2!=e.originalEvent.touches.length)return!1;var t=LastTouchDist;return LastTouchDist=TouchDist(e),0===t||LastTouchDist===t?1:LastTouchDist<t?2:3}function MinSuc(){$(".arcticmodal-container").hide("slow"),$(".arcticmodal-overlay").hide(),$("#sucreturn").show("slow"),$("body").css("overflow","auto")}function MinExp(){$(".arcticmodal-container").show("slow"),$(".arcticmodal-overlay").show(),$("#sucreturn").hide("slow"),$("body").css("overflow","hidden")}function SuccessModal(e,t,a){if(GameTimerStop=!0,IsSuc=!0,watchStreamEnabled)return!1;t={mode:"successmodal",id:e,pos:t,ggid:GGID,glat:GlAT};duelId&&(t.duel=duelId),jQuery.arcticmodal({afterClose:function(e,t){IsSuc=!1,void 0!==SF1&&(SF1.detach(),SF2.detach(),jQuery(SF1).insertAfter("#lsf1"),jQuery(SF2).insertAfter("#lsf2"),jQuery("#lsf1").remove(),jQuery("#lsf2").remove())},closeOnOverlayClick:!1,type:"ajax",url:"/actions.php",ajax:{type:"POST",cache:!1,data:t,dataType:"html",success:function(e,t,o){void 0!==a&&""!=a&&(o=o.replace("\x3c!--INTXT--\x3e","<div>"+a+"</div>")),e.body.html(o)}}})}function ShowEditVariant(e){jQuery.post("/newactions.php",{mode:"getunivariant",id:e,auth:1},function(e){var t=JSON.parse(e);t.iserror?alert(t.message):((e=$('<div class="box-modal"></div>')).html(t.html),e.prepend('<div class="box-modal_close arcticmodal-close">X</div>'),$.arcticmodal({content:e}))})}function SetHandsAction(){$(document).on("click",".hand",function(e){var t,o;t=$(this).hasClass("handup")?1:-1,o=$(this).hasClass("sz12")?1:0;var a=$(this).attr("abbr"),n=$(this).html(),r=this;$.post("/actions.php",{mode:"komgolos",id:a,md:t,tbl:o},function(e){isNumber(e)?(n=n.replace(/[0-9]+/,e),$(r).html(n)):alert(e)})})}function Friend(e,t,o){o=void 0===o?0:1,$(e).hasClass("disabled")||window.confirm(LG.sure)&&($(".todis").addClass("disabled"),$.post("/actions.php",{mode:"friends",id:t,md:o}))}function PublicFollow(e,t,o){window.confirm(LG.sure)&&($(t).prop("disabled","disabled"),$.post("/actions.php",{mode:"publicfollow",id:e},function(e){"!"==e?void 0===o&&location.reload():(alert(e),$(t).prop("disabled",""))}))}function FastBuy(){var t=$("#fb_cnt").val(),a=$("#fb_id").val(),o=0,e=$("#fixedprice").prop("checked");void 0!==e&&!0===e&&(o=parseInt($("#FastBuyBut").attr("abbr"))),NewActions({mode:"CalcFastBuy",id:a,cnt:t,auth:1,fixedprice:o},function(e){window.confirm(e.message)&&NewActions({mode:"FastBuy",cnt:t,auth:1,id:a,mn:e.maxmoney,fixedprice:o},function(e){var t,o;$("#moneys").text(e.money),alert(e.message),e.iserror||($.arcticmodal("close"),o=(t=parseInt($("#counter_"+a).text()))+e.incitems,$("#counter_"+a).text(o),o="#actcont_"+a,0==t&&$(o).length&&$(o).html(e.actbut))},1,["#FastBuyBut",!0])},function(){LGAlert("nostore")},["#FastBuyBut",!0])}function FastSell(){var t=$("#fs_cnt").val(),o=$("#fb_id").val(),a=0,e=$("#fixedprice").prop("checked");void 0!==e&&!0===e&&(a=parseInt($("#FastSellBut").attr("abbr"))),NewActions({mode:"CalcFastSell",id:o,cnt:t,auth:1,fixedprice:a},function(e){window.confirm(e.message)&&NewActions({mode:"FastSell",cnt:t,auth:1,id:o,fixedprice:a},function(e){var t;$("#moneys").text(e.money),alert(e.message),e.iserror||($.arcticmodal("close"),t=parseInt($("#counter_"+o).text())-e.decitems,$("#counter_"+o).text(t),e="#actcont_"+o,0==t&&$(e).length&&$(e).html(""))},1,["#FastSellBut",!0])},function(e){LGAlert(e.message)},["#FastSellBut",!0])}function NewHead(e){var t=$("#sh"+e).val();$.post("/actions.php",{mode:"setkhead",id:e,txt:t},function(e){alert(e),jQuery.facebox.close()})}function SetHead(e){var t=$("#ik_hdr_"+e).text();jQuery.facebox('<input style="width:250px;" id="sh'+e+'" type="text" value="'+t+'" /><input type="submit" style="width:50px;" value="OK" onclick="NewHead('+e+');">')}function DelC(e,t){return!!window.confirm(LG.sure)&&($.post("/save.php",{mode:"4",url:e,tip:t},function(e){alert(e)}),$(".tr_"+e).remove(),!0)}function CoopAccess(){var e=$("#coopaccess").val();NewActions({mode:"CoopAccess",id:CoopID,access:e,auth:1})}function PlayStage(e){NewActions({mode:"playmissionstage",id:e,auth:1},function(e){IsFrame?location.href=SiteName+e.url+"?ifr=1":location.href=SiteName+e.url},function(e){alert(e.message),LoadMisionSteps()},"#mission_steps_cont")}function CoopHideControls(){CoopID=0,$("#coopcontrol").hide(),$("#coopchat").hide(),$("#coopbut").hide(),WSC.close()}function WSStartPlay(){NewActions({mode:"StartCoop",id:GGID,auth:1},function(e){var t=!0;e.new?alert(e.message):t=window.confirm(e.message),t&&(WSError=function(){CoopHideControls(),LGAlert("nocoopserver")},$(e.achtml).insertBefore("#coopbut"),CoopID=e.coopid,$("#coopbut").hide(),0==$("#coopchat").length&&($("body").append(e.chat),$("#coopchatmes").keydown(function(e){13===e.keyCode&&WSSendChat()}),dragElement(document.getElementById("coopchat"))),setInterval(function(){CoopID&&NewActions({mode:"UpdateCoop",id:CoopID,auth:1})},5e4),"undefined"==typeof IsWSC&&$("head").append('<script src="https://grandgames.net/js/coopclient.js?5" type="text/javascript"><\/script>'))},1)}function ShowCoopLabel(e,t,o,a){coopTML&&clearTimeout(coopTML);var n="cooplab_"+o;$(n).hide();var r="#"+n;0==$(r).length&&$("body").append('<span class="cooplabel" id="'+n+'">'+o+"</span>"),$(r).show(),void 0!==a?$(r).animate({top:t-30,left:e-30},a):($(r).css("top",t-30),$(r).css("left",e-30)),coopTML=setTimeout(function(){$(".cooplabel").hide("slow")},1e3)}function dragElement(a){var n=0,r=0,c=0,i=0;function e(e){e=e||window.event,c=e.clientX,i=e.clientY,void 0===c&&(c=e.targetTouches[0].pageX,i=e.targetTouches[0].pageY),document.onmouseup=o,document.ontouchend=o,document.onmousemove=t,document.ontouchmove=t,ImgMove=!0}function t(e){var t=(e=e||window.event).clientX,o=e.clientY;void 0===t&&(t=e.targetTouches[0].pageX,o=e.targetTouches[0].pageY),n=c-t,r=i-o,c=t,i=o,a.style.top=a.offsetTop-r+"px",a.style.left=a.offsetLeft-n+"px"}function o(){ImgMove=!1,document.onmouseup=null,document.onmousemove=null,document.ontouchend=null,document.ontouchmove=null}document.getElementById(a.id+"header")?(document.getElementById(a.id+"header").onmousedown=e,document.getElementById(a.id+"header").ontouchstart=e):a.onmousedown=e}function startFullScreen(e){element=$(e)[0],element.requestFullscreen?element.requestFullscreen():element.mozRequestFullScreen?element.mozRequestFullScreen():element.webkitRequestFullscreen?element.webkitRequestFullscreen():element.msRequestFullscreen&&element.msRequestFullscreen()}function exitFullScreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function ShowHTMLWindow(e,t,o){void 0===t&&(t=0),void 0===o&&(o=0),jQuery.post("/newactions.php",{mode:e,id:t,auth:o},function(e){var t=JSON.parse(e);t.iserror?alert(t.message):((e=$('<div class="box-modal"></div>')).html(t.message),e.prepend('<div class="box-modal_close arcticmodal-close">X</div>'),$.arcticmodal({content:e}))})}function ShowTipsWindow(){ShowHTMLWindow("gettipswindow")}function noChips(){LGAlert("nochips",()=>{ShowHTMLWindow("getfbwindow",886)})}function ShowRegWindow(){ShowHTMLWindow("getregtext")}function ModalURL(e,t){void 0===t&&(t={}),jQuery.post(e,t,function(e){var t=$('<div class="box-modal"></div>');t.html(e),t.prepend('<div class="box-modal_close arcticmodal-close">X</div>'),$.arcticmodal({content:t})})}function ModalWindow(e){var t=$('<div class="box-modal"></div>');t.html(e),t.prepend('<div class="box-modal_close arcticmodal-close">X</div>'),$.arcticmodal({content:t})}function NFSClose(){$("#nfsblock").hide(100),$("#nfsin").empty()}function NFSShow(e,t){var o,a;$("#nfscloser").show(0),void 0!==t&&(o=$(document).width(),a=windowHeight(),"youtube"===t.mode&&(1280<o&&(o=1280),a=Math.ceil(9/16*o),$("#nfsin").width(o),$("#nfsin").height(a),e='<iframe width="'+o+'" height="'+a+'" src="https://www.youtube.com/embed/'+e+'" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope;" allowfullscreen></iframe>'),!0===t.noclose&&$("#nfscloser").hide(0)),void 0!==e&&""!==e&&$("#nfsin").html(e),$("#nfsblock").show()}function YouTube(e){NFSShow(e,{mode:"youtube"})}function ModalText(e){jQuery.post("/newactions.php",e,function(e){e=JSON.parse(e);e.iserror?LGMes("error"):ModalWindow(e.message)})}function ChangeSkin(e){ModalText({mode:"changeskin",agid:e})}function ShowPictureWindow(e){var t=jQuery('<div class="box-modal" style="max-width: 100vw;max-height: 100vh;"><img id="spw_img" src="//grandgames.net/img/load.gif" alt="Loading..." /></div>');t.prepend('<div class="box-modal_close arcticmodal-close">X</div>'),jQuery.arcticmodal({content:t}),jQuery.get(e,function(){jQuery("#spw_img").attr("src",e)})}function GuestReg(){jQuery("#grlink").html(LoadString);var t=LastGfunc;LastGfunc=!1,jQuery.post("/newactions.php",{mode:"guestreg"},function(e){e=JSON.parse(e);e.iserror||(NoReload?(CurUser=e.ind,UIND=e.ind,UserLogin=e.login,jQuery("#right_header").html("<b>"+UserLogin+'</b> <img src="//grandgames.net/img/icon/money.png" alt=""><b id="moneys">100</b>'),$.arcticmodal("close"),!1!==t&&window[t]()):location.reload())})}function ShowEditTagForm(e,t){jQuery.post("/newactions.php",{mode:"ShowEditTagForm",tag:e,place:t,auth:1},function(e){e=JSON.parse(e);e.iserror?alert(e.message):$("#pti_cont").html(e.html)})}function PuzzleInfoSave(){var e=$("#pti_tag").val(),t=$("#pti_nom").val(),o=$("#pti_descr").val(),a=$("#pti_place").val(),n=void 0===(n=$("#pti_menu").prop("checked"))?0:n?2:1;jQuery.post("/newactions.php",{mode:"EditTag",menu:n,descr:o,nom:t,tag:e,place:a,auth:1},function(e){e=JSON.parse(e);e.iserror?alert(e.message):location.reload()})}function DisabMes(){jQuery.post("/lg.php",{s:"disabmes"},function(e){var t=$('<div class="box-modal"></div>');t.html(e),t.prepend('<div class="box-modal_close arcticmodal-close">X</div>'),$.arcticmodal({content:t})})}function LGMes(e,o){jQuery.post("/lg.php",{s:e},function(e){var t=$('<div class="box-modal"></div>');t.html(e),t.prepend('<div class="box-modal_close arcticmodal-close">X</div>'),$.arcticmodal({content:t}),"function"==typeof o&&o()})}function LGAlert(e,t,o,a){var n=!1;if(void 0!==t){var r=typeof t;if("object"===r){if(void 0!==t.obj&&!0===jQuery(t.obj).prop("disabled"))return!1;(n=void 0!==t.bw&&void 0!==t.obj)&&(jQuery(t.obj).css("filter","grayscale(1)"),jQuery(t.obj).prop("disabled",!0))}}jQuery.post("/lg.php",{s:e},function(e){mixAlert(e+(a=void 0===a?"":a)),n&&(jQuery(t.obj).css("filter","none"),jQuery(t.obj).prop("disabled",!1)),"function"===r?t():void 0!==o&&"function"==typeof o&&o()})}function mixAlert(e){AppVersion?AppQ("message",e):alert(e)}function GetLG(e,t){jQuery.post("/lg.php",{s:e},function(e){t(e)})}function MLoadTrends(){return!1}function LoadTrends(){return!1}function MakeShot(t,o){var e,a=!1;"object"==typeof game&&"object"==typeof game.canvas?a=game.canvas:"object"==typeof $("#canvas")&&(a=document.getElementById("canvas")),a?(NowShot=!0,o.img=a.toDataURL(),NowShot=!1,t(o)):(e=".rec_cont",0==jQuery(e).length&&(e="#gamediv"),0==jQuery(e).length&&(e="#cross_div table"),0==jQuery(e).length&&(e=".cross_div table"),0==jQuery(e).length&&(e="body"),0!=jQuery(e).length&&(900<(a=$(e).height())&&(a=900),NowShot=!0,html2canvas(document.querySelector(e),{logging:!1,height:a}).then(function(e){e=e.toDataURL("image/png");o.img=e,NowShot=!1,t(o)})))}function GetPageName(){var e=jQuery("meta[property='gg:tbl']").attr("content");return""==e?"":e+"_"+jQuery("meta[property='gg:id']").attr("content")}function add_script(e,t){var o=document.createElement("script");o.type="text/javascript",0!==e.indexOf("http")?o.src=SiteName+"/js/"+e:o.src=e,document.getElementsByTagName("head")[0].appendChild(o),o.onload=t}function ScreenShot(){NowShot||add_script("html2canvas.min.js",function(){var t=jQuery("#makeshot").attr("src");jQuery("#makeshot").attr("src","/img/loadsmall.gif"),DoShot(function(e){jQuery("#makeshot").attr("src",t),e.iserror||ModalWindow(e.html)})})}function DoShot(t){MakeShot(function(e){jQuery.ajax({type:"POST",url:"/newactions.php",data:e}).done(function(e){e=JSON.parse(e);"function"==typeof t&&t(e)})},{mode:"framesave",url:GetPageName(),auth:1})}function DoRecord(){MakeShot(function(e){FrameCounter++,jQuery.ajax({type:"POST",url:"/newactions.php",data:e}).done(function(e){JSON.parse(e);setTimeout(function(){FrameCounter<3e3&&DoRecord(1)},1e3)})},{mode:"framesave",url:GetPageName(),id:FrameCounter,auth:1})}function GSEWork(){2<jQuery("#gse_inp").val().trim().length&&GSCanShow&&(GSCanShow=!1,add_script("https://cse.google.com/cse.js?cx=002085727349897877881:ahamwcetsm8",function(){jQuery("#gse").show(),jQuery("#gse").css("top","30px"),setTimeout(function(){var e=jQuery("#gse_inp").val().trim();jQuery("#gse_inp").hide(),jQuery("#gsc-i-id1").val(e),jQuery("#gsc-i-id1").focus()},500)}))}function ToIndexLocation(e){var t=SiteName+"/index.php";t+=e,document.location=t}function ToLocation(e){document.location=e}function GCaptcha(e,t){""!==GV3?GExecute(e,t):(void 0!==e&&""!==e||(e="login"),loadScript("https://www.google.com/recaptcha/api.js?render=6Lcn1c8UAAAAAKHiT3fLOKsd9nkNhlwvoBnht7iZ",function(){grecaptcha.ready(function(){GExecute(e,t)})}))}function loadScript(i,d){return new Promise(function(e,t){var o,a,n;function r(){clearTimeout(a),a=null,o.onerror=o.onreadystatechange=o.onload=null}function c(){r(),(!o.onreadystatechange||o.readyState&&"complete"==o.readyState)&&e(o)}i?(o=document.createElement("script"),(n=document.getElementsByTagName("head")[0]).appendChild(o),o.onerror=function(e){r(),n.removeChild(o),o=null,t(new Error("network"))},void 0===o.onreadystatechange?o.onload=c:o.onreadystatechange=c,a=setTimeout(5e3),o.setAttribute("type","text/javascript"),o.setAttribute("src",i),o.onload=d):t(new TypeError("filename is missing"))})}function GExecute(e,t){grecaptcha.execute("6Lcn1c8UAAAAAKHiT3fLOKsd9nkNhlwvoBnht7iZ",{action:e}).then(function(e){jQuery(".gv3").val(e),GV3=e,void 0!==t&&"function"==typeof t&&t()})}function ShowLF(){$("#lfshow").removeClass("dashedlink"),$("#lfshow").html('<img src="//grandgames.net/img/load.gif" alt="Loading..." />'),GCaptcha("login",function(){$("#lfshow").hide(),jQuery("#logininputs").show()})}function TGFB(){FBHided?(FBHided=!1,$("header").show(100),$("#fb_hider").attr("src","/img/app/32/hidefp.png"),$("#main_panel").animate({marginTop:36},200,"linear",function(){window.dispatchEvent(new Event("resize"))})):($(".toframebuttons").hide(),$("#left_panel").hide(),FBHided=!0,$("header").hide(300),$("#main_panel").animate({marginTop:0},200,"linear",function(){window.dispatchEvent(new Event("resize"))}),$("#fb_hider").attr("src","/img/app/32/showfp.png"))}function UniDescEditShow(e,t,o,a){UniDesc=$(e).parent(),TempLink=$(UniDesc).html(),$(UniDesc).html(LoadString),void 0===a&&(a=0),jQuery.post("/newactions.php",{mode:"getunidescedit",id:t,tbl:o,auth:1,editnom:a},function(e){e=JSON.parse(e);e.iserror?($(UniDesc).html(TempLink),alert(e.message)):$(UniDesc).html(e.txt)})}function AdminK(e,t,o){window.confirm(LG.sure)&&((2==o?$("#tr_s"+e):$("#tr_"+e)).remove(),$.post("/save.php",{mode:"5",kind:t,url:e,md:o},function(e){mixAlert(e)}))}function agListOps(e,t,o){console.log(e,t),"agmoveblack"==t?($(o).parent().parent().hide(),NewActions({mode:"agmoveblack",auth:1,id:e})):"agmovedelsave"==t&&($(o).parent().parent().removeClass("pm_saved"),$(o).hide(),NewActions({mode:"agmovedelsave",auth:1,id:e}))}function DelK(e,t){window.confirm(LG.sure)&&((2==t?$("#tr_s"+e):$("#tr_"+e)).remove(),$.post("/save.php",{mode:"5",url:e,md:t},function(e){mixAlert(e)}))}function DelH(e,t){window.confirm(LG.sure)&&((2==t?$("#tr_s"+e):$("#tr_"+e)).remove(),$.post("/save.php",{mode:"6",url:e,md:t},function(e){mixAlert(e)}))}function DelR(e){$.post("/save.php",{mode:"8",url:e},function(e){alert(e),location.reload()})}function DecMoney(){var e=parseInt($("#moneys").text());return e<=0?(LGAlert("nomoney"),!1):($.post("/save.php",{mode:"9",url:currentURL}),e-=1,$("#moneys").text(e),!0)}function DelMoney(e){if(0<UIND){var t=parseInt($("#moneys").text());return 0<t?(t-=1,$("#moneys").text(t),$.post("//grandgames.net/save.php",{mode:"9",url:"1"}),void 0!==e&&"function"==typeof e&&e(),!0):(LGAlert("nomoney"),!1)}return AfterRegFunction=function(){DelMoney(e)},ShowRegWindow(),!1}function HaveHint(t,e){NewActions({mode:"HaveHint",auth:1,sm:e},function(e){t()},function(){ShowTipsWindow()})}function DelHint(t,e,o){return IsTNM?(LGAlert("nohinttnm"),!1):(void 0===o&&(o=1),0<UIND?(NewActions({mode:"DelHint",auth:1,sm:o},function(e){$("#mytips").text(e.tips),$("#moneys").text(e.money),t()},function(){void 0!==j.money&&$("#moneys").text(j.money),LGAlert("lowmoneyfromhint")},[e,!0]),!0):(AfterRegFunction=function(){DelHint(t,e,o)},ShowRegWindow(),!1))}function ShowPuzzleTop(e,t){$.post("/showtop.php",{url:e,mode:"2",lev:t},function(e){$("#showtop").html(e),jQuery.facebox({div:"#showtop"})})}function UploadKImage(e,n){jQuery("#load_kimage").html(LoadString);var o=new FormData;jQuery.each(e,function(e,t){o.append(e,t)}),o.append("mode","uploadkimage"),jQuery.ajax({url:"/actions.php",type:"POST",data:o,cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(e,t,o){var a=e.resp;"h"==a[0]||"/"==a[0]?GetLG("insertink",function(e){$("#load_kimage").html('<div style="font-size:10px;">'+a+'<button style="width:400px;" onclick="var v=jQuery(\'#'+n+"').val();jQuery('#"+n+"').val(v+' "+a+" ');jQuery.facebox.close();\">"+e+'</button></div><hr /><img src="'+a+'">')}):$("#load_kimage").html("Error! "+a)},error:function(e,t,o){alert("Error! "+t+" "+e+" "+o)}})}function SetCurTag(e){e=(e=$(e).val()).substr(0,e.indexOf(" ")),e=NowTagText.substr(0,NowTagTextStart)+e+NowTagText.substr(NowTagTextEnd);$(AjaxTagInput).val(e),$("#ajaxtags").hide(),$(AjaxTagInput).focus()}function ShowAGTop(e){$.post("/showtop.php",{url:e,mode:"6"},function(e){ModalWindow(e)})}function BindPost(t,o){jQuery.post("/actions.php",{mode:"bindpost",t:t,id:o},function(e){"!"==e?0==t?$("#bnd"+o).attr("src","//grandgames.net/img/icon/bindadd.png"):$("#bnd"+o).attr("src","//grandgames.net/img/icon/binddel.png"):alert(e)})}function ChangeAccess(e,t){var o=$("#caseaccess").val();jQuery.post("/actions.php",{mode:"changeaccess",url:t,id:e,access:o},function(e){alert(e),location.reload()})}function SendKomment(o,e,a,t,n){n=void 0===n||0==n?0:1;var r,c,i="add_ta_"+o,d="#add_kmn_"+o;c=0==(r="self"==e?0:1)?jQuery("#tr_"+o):jQuery("#tr2_"+o);var s=jQuery("#"+i).val();jQuery("#btn_"+o).hide();var l=0;$(d+" select").length&&(l=$(d+" select").val());function u(){jQuery.post("/actions.php",{mode:"addk",anonim:n,url:e,moder:l,id:o,txt:s,access:PostAccess,md:t,rblock:RBlock},function(e){var t;0==r?(t=jQuery(d),jQuery(t).remove()):(jQuery("#"+i).val(""),jQuery("#btn_"+o).show()),0==a?jQuery(c).append(e):jQuery(c).prepend(e),jQuery("#ka_"+o).show(),jQuery("#ka_"+o).appendTo(c)})}UIND?u():(AfterRegFunction=u,ShowRegWindow())}function EditPost(e,t){ShowADDForm(e,"","edit",t)}function SaveAndUpdatePost(e,t){var o;o=2==t?"msgs_"+e:"msg_"+e;var a=jQuery("#"+("add_ta_"+e)).val();jQuery("#"+o).html(LoadString),jQuery.post("/actions.php",{id:e,mode:"updatepost",txt:a,md:t},function(e){jQuery("#"+o).html(e),FB()})}function ShowSmiles(e,t){SmileTarget=t,jQuery("#addsmiles").length||(jQuery("#all").append('<div id="addsmiles"></div>'),jQuery("#addsmiles").load(SiteName+"/scripts/smiles.php",()=>{try{JSON.parse(GetConfig("smiles","[]")).forEach(e=>{console.log(e),jQuery("#addsmiles").prepend(e)})}catch(e){}}));var o=document.body.clientWidth,a=document.body.clientHeight;o<550?(jQuery("#addsmiles").show(),jQuery("#addsmiles").css("top",0),jQuery("#addsmiles").css("left",0)):(e=(t=jQuery(e).offset()).left+20,a<(t=(t=t.top-700)<0?0:t)+700&&(t=a-700),o<e+550&&(e=o-550),jQuery("#addsmiles").show(),jQuery("#addsmiles").css("top",t),jQuery("#addsmiles").css("left",e))}function doAddTags(e,t,o){var a,n,r,c,i;textarea=document.getElementById(o),document.selection?(textarea.focus(),(i=document.selection.createRange()).text=e+i.text+t):(a=textarea.value.length,n=textarea.selectionStart,r=textarea.selectionEnd,c=textarea.scrollTop,o=textarea.scrollLeft,i=e+(i=textarea.value.substring(n,r))+t,textarea.value=textarea.value.substring(0,n)+i+textarea.value.substring(r,a),textarea.scrollTop=c,textarea.scrollLeft=o,textarea.focus(),t=r+e.length+t.length,textarea.selectionStart=t,textarea.selectionEnd=t)}function doImage(e){textarea=document.getElementById(e),jQuery.facebox('<div id="load_kimage"><input type="file" accept="image" name="load" onchange="UploadKImage(this.files,\''+e+"');\"></div>")}function doURL(e){textarea=document.getElementById(e);var t,o,a,n=prompt("Enter the URL:","//"),r=textarea.scrollTop,c=textarea.scrollLeft;""!=n&&null!=n&&(document.selection?(textarea.focus(),""==(a=document.selection.createRange()).text?a.text="[url]"+n+"[/url]":a.text="[url="+n+"]"+a.text+"[/url]"):(t=textarea.value.length,o=textarea.selectionStart,e=textarea.selectionEnd,a=""==(a=textarea.value.substring(o,e))?"[url]"+n+"[/url]":"[url="+n+"]"+a+"[/url]",textarea.value=textarea.value.substring(0,o)+a+textarea.value.substring(e,t),textarea.scrollTop=r,textarea.scrollLeft=c))}function AgreeCoockie(){jQuery.post("/coockie.php",{c:"agreecoockie",n:1}),jQuery("#coockie_mes").hide()}function CheckFreeSpace(){var e=jQuery(".SizeFixer");0==e.length&&0==(e=jQuery("#cross_div table")).length&&(e=jQuery(".cross_div table"));var t,o,a=void 0===ScrollObject;ScrollObject=$(e).parent(),0!=e.length&&(t=jQuery(e).width()+25,o=jQuery("#main_panel").width(),jQuery("body").hasClass("pzdispl")||o<t&&MakeSiteWide(1),(o=jQuery("#main_panel").width())<t?(e=jQuery(document).width(),$("#fixedscroll_in").width(e+t-o),$("#fixedscroll").show(),a&&$(ScrollObject).on("scroll",function(){var e;2!=DisableFixScrol&&(void 0!==ScrollTimer&&clearTimeout(ScrollTimer),DisableFixScrol=1,e=$(ScrollObject).scrollLeft(),$("#fixedscroll").scrollTo(e),ScrollTimer=setTimeout(function(){DisableFixScrol=0,ScrollTimer=void 0},300))})):$("#fixedscroll").hide())}function ShowAllKoments(e){$(e).hide(),$(e).parent().find(".f_mes").show()}function TogleSound(){NoSound=1-NoSound,SetLocalVal("nosound",NoSound),SetSoundLBL()}function SetSoundLBL(){var e,t="#tgsound";$(t).length&&(e=1==NoSound?"nosound":"sound",$(t).html('<img src="'+SiteName+"/img/icon/"+e+'.png" alt="'+NoSound+'" />'))}function setTheme(e){nowTheme=e,$("#themeimage").attr("src","/img/theme/"+e+".png"),RememberVal(e,"theme"),setFontTheme()}function setFont(e){nowFont=e,RememberVal(e,"font"),setFontTheme()}function setFontTheme(){$("#mainfont").remove(),$("#maintheme").remove(),$("body").append('<link id="mainfont" type="text/css" rel="stylesheet" media="all" href="https://grandgames.net/css/font_'+nowFont+".css?v="+SiteVersion+'" />'),$("body").append('<link id="maintheme" type="text/css" rel="stylesheet" media="all" href="https://grandgames.net/css/'+nowTheme+".css?v="+SiteVersion+'" />'),$("#themeslist").hide()}function chatEnter(){$("#chatEnterBut").hide(),$("#coopchat").show(),chatPlace="common",wsSend({m:"chatwatch",chat:chatPlace,login:UserLogin})}function chatSend(){wsSend({m:"chatsend",chat:chatPlace,mes:$("#coopchatmes").val()}),$("#coopchatmes").val("")}function WSConnect(t){socket=new WebSocket("wss://grandgames.net:8081"),WSTryConnect=!0,socket.onopen=function(e){console.log("wsopen"),Comet=!0,setInterval(function(){Comet&&socket.send("!")},2e4),"function"==typeof t&&t()},socket.onclose=function(e){Comet=!1},socket.onerror=function(e){Comet=!1},socket.onmessage=function(e){WSWork(e.data)}}function addNull(e){return e=parseInt(e)<10?"0"+e:e}function WSWork(e){try{var t,o,a,n,r,c,i,d=e.match(/^(ws_[a-z0-9]+?)=(.*?)$/);null!==d?(t=d[1],o=d[2],void 0!==WSFuncs[t]&&("function"==typeof WSFuncs[t]?WSFuncs[t](o):window[WSFuncs[t]](o))):"ag"==(a=JSON.parse(e)).m?(watchStreamEnabled&&"function"==typeof watchStreamFunc&&(watchStreamFunc(a.save),r=addNull((n=new Date).getHours())+":"+addNull(n.getMinutes())+":"+addNull(n.getSeconds()),$("#streamLastTime").html(r)),c=a.proc,i=".indicator_proc_"+a.uid+"_"+a.agid,$(i).length&&$(i).html(c+"%"),i=".indicator_mask_"+a.uid+"_"+a.agid,$(i).length&&a.mask.length&&$(i).html(buildAgTable(a.mask,a.sx))):"chat"==a.m?($("#coopchattext").append("<div><b>"+a.login+"</b> "+a.cdate+"<br>"+a.mes+"</div>"),setTimeout(function(){$("#coopchattext").scrollTop($("#coopchattext").prop("scrollHeight"))})):"chatusers"==a.m?$("#coopchatplayers").html(a.users):"push"==a.m?lastPushMes!==a.html&&PushWindow(a.html):"function"==typeof WSFuncs[a.m]&&WSFuncs[a.m](a)}catch(e){}}function addToWatchList(e,t,o,a=!1){var n;UIND&&(n=e+"_"+t,$("#agwatcher_all").length?void 0===watchList[n]&&(watchList[n]=!0,n="",n=a?'<a href="/puzzlebyid.php?id='+t+"&stream="+e+'" class="button"><img width="16" height="16" src="/img/menu/streams.png" alt="-"> #'+t+"</a> ":'<a href="/id'+t+'">#'+t+"</a> ",$("#agwatcher_all").append('<div class="agwatcher_in"><div><a href="/user/'+o.toLowerCase()+'">@'+o+"</a></div><div>"+n+'<span style="font-weight: bold" class="agindicator indicator_proc_'+e+"_"+t+'"></span></div><div class="agindicator indicator_mask_'+e+"_"+t+'"></div></div>'),wsSend({m:"agwatch",agid:t,uid:e})):setTimeout(function(){addToWatchList(e,t,o,a)},1e3))}function PostShare(e){var t="pshare_"+e,o=SiteName+"/post/"+e;NewActions({mode:"pageinfo",url:o},function(e){Ya.share2(t,{content:{url:o,title:e.title,description:e.description,image:e.image},theme:{services:"vkontakte,facebook,odnoklassniki,gplus,twitter,viber,whatsapp,skype,telegram",size:"s",bare:!1}})},1,"#"+t)}function MakeSound(e){if(0==NoSound){var t="";if(void 0===e?t="mes.aac":0===e?t="hod.aac":1===e?t="take.acc":"success"===e?t="success.wav":"steal"===e?t="steal.wav":"error"===e&&(t="error.wav"),""!==t)try{Sound.src="https://grandgames.net/sound/"+t,Sound.play()}catch(e){console.log(e)}}}function PushWindow(e){var t,o;1<e.length&&(null===(t=(lastPushMes=e).match(/^([a-z0-9_-]{2,20})\|?(.*?)$/))?PushWindowShow(e):(e=t[1],""!=(o=t[2])&&(o="<br>"+o),jQuery.post("/lg.php",{s:e},function(e){PushWindowShow(e+" "+o)})))}function strip_tags(e){return e.replace(/<\/?[^>]+>/gi,"")}function PushWindowShow(e){CanShowMes&&(AppVersion?AppQ("message",strip_tags(e)):(jQuery("#wsmes").html(e),jQuery("#wsmes").show("slow"),setTimeout(function(){CanShowMes=!0,jQuery("#wsmes").hide("slow")},5e3)),CanShowMes=!1)}function ExGoodSize(e,t){1<t?($(e).css("font-size",EXFSmall),$(e).css("font-weight","normal")):($(e).css("font-weight","bold"),$(e).css("font-size",EXFNormal))}function SendChatMes(){var e=jQuery("#newchat_input").val();jQuery("#newchat_input").val(""),jQuery.post("/actions.php",{mode:"sendchatmes",mes:e,lastmesid:LastMesID},function(e){Comet||(UpdateChat(trim(e)),jQuery("#newchat_div").scrollTo("max",500))})}function MakeSiteWide(e){void 0===UnWide&&(UnWide=!jQuery("body").hasClass("pzdispl")),UnWide&&((e=null==e?!jQuery("body").hasClass("pzdispl"):e)?jQuery("body").addClass("pzdispl"):jQuery("body").removeClass("pzdispl")),$(window).resize()}function agOpen(e){document.location.assign(SiteName+"/id"+e)}function buildAgTable(e,t){var o=0;t<1&&(t=1);for(var a=Math.floor(e.length/t),n="<table>",r=0;r<a;r++){n+="<tr>";for(var c=0;c<t;c++)n+='<td rel="s'+e[o]+'"></td>',o++;n+="</tr>"}return n+="</table>"}function iColorShow(t,e){e=jQuery("#"+e).offset();jQuery("#iColorPicker").css({top:e.top+jQuery("#"+t).outerHeight()+"px",left:e.left+"px",position:"absolute"}).fadeIn("fast"),jQuery("#iColorPickerBg").css({position:"fixed",top:0,left:0,width:"100%",height:"100%"}).fadeIn("fast");e=jQuery("#"+t).val();jQuery("#colorPreview span").text(e),jQuery("#colorPreview").css("background",e),jQuery("#color").val(e);var o=jQuery("#iColorPicker");for(i=0;i<o.length;i++){var a=document.getElementById("hexSection"+i).childNodes;for(j=0;j<a.length;j++){var n=a[j].childNodes;for(k=0;k<n.length;k++)jQuery(a[j].childNodes[k]).unbind().mouseover(function(e){var t="#"+jQuery(this).attr("hx");jQuery("#colorPreview").css("background",t),jQuery("#colorPreview span").text(t)}).click(function(){var e="#"+jQuery(this).attr("hx");jQuery("#"+t).val(e).css("background",e),jQuery("#puzzle_field").css("background-color",e),jQuery("#iColorPickerBg").hide(),jQuery("#iColorPicker").fadeOut(),jQuery("#"+t).click(),jQuery(this)})}}}jQuery(document).on("input",".exstbl tr td textarea",function(e){ExGoodSize(this,jQuery(this).val().length)}),$(document).on("mousedown","#addsmiles img",function(e){var t=jQuery(this).attr("alt"),o=this.outerHTML;console.log(o),doAddTags("",":"+t+":",SmileTarget),jQuery("#addsmiles").hide();try{var a=JSON.parse(GetConfig("smiles","[]"));a.push(o),14<(a=a.filter((e,t,o)=>o.indexOf(e)===t)).length&&a.shift(),SetConfig("smiles",JSON.stringify(a)),console.log(a)}catch(e){SetConfig("smiles","[]")}return!1}),jQuery(document).on("click",".togler_span",function(){jQuery(this).find("span").toggle()}),$(window).resize(function(){CheckFreeSpaceTimer||(CheckFreeSpaceTimer=!0,setTimeout(function(){CheckFreeSpaceTimer=!1,CheckFreeSpace()},100))}),jQuery(document).on("click",".soclink",function(e){TermsChecked||(jQuery("#termslink").css("color","red"),LGAlert("needacceptterms"),setTimeout(function(){jQuery("#termslink").css("color","black")},500),e.preventDefault())}),$(document).on("click","#UniDescSubmit",function(){var e=$("#unidesctbl").val(),t=$("#unidescid").val(),o=$("#unidesctxt").val(),a=$("#unideschide").val(),n=$("#unirunom").val(),r=$("#uniennom").val();$(UniDesc).prepend(LoadString),jQuery.post("/newactions.php",{mode:"saveunidesc",txt:o,id:t,tbl:e,auth:1,hide:a,runom:n,ennom:r},function(e){e=JSON.parse(e);e.iserror?($("#loadindicator").hide(),alert(e.message)):($(UniDesc).html(TempLink),$("#mainopis").html(o),$("#mainopis").show())})}),jQuery(document).on("click",".expander",function(){var e=$(this).find("h2");e.hasClass("expanded")?e.removeClass("expanded"):e.addClass("expanded"),$(this).find(".expander_in").toggle("fast")}),jQuery(document).ready(function(){NoSound=GetLocalVal("nosound",0),SetSoundLBL(),jQuery(document).on("click","#tgsound",function(){TogleSound()}),jQuery(document).on("click","#themes",function(){jQuery("#themeslist").css("left",jQuery("#themes").offset().left-30).toggle()}),jQuery(document).on("click",".pm_show_buts",function(){$(this).parent().find("img").toggle(),$(this).show()}),jQuery(document).on("click","#follow_img",function(){var e=0;jQuery(this).hasClass("cb")?(e=1,jQuery(this).removeClass("cb")):jQuery(this).addClass("cb"),jQuery.post("/newactions.php",{auth:1,mode:"favorkat",id:FeedID,m:e})}),$(document).on("click","#topmonthplayers tr td",function(){var e=(e=$(this).text()).toLowerCase().trim();location.href=SiteName+"/user/"+e}),$(".nav ul li").click(function(e){var t;"A"!=e.target.nodeName&&$(this).find(".menu_expander").length&&(t=$(this)).find(".submenu").toggle("fast",function(){t.hasClass("expanded")?t.removeClass("expanded"):t.addClass("expanded")})}),jQuery(document).on("click","a[rel*=facebox]",function(e){var t=jQuery(this).attr("href"),o=t.split(".").pop().substr(0,3);return("gif"==o||"jpg"==o||"png"==o||"bmp"==o?ShowPictureWindow:ModalURL)(t),!1}),$("#fixedscroll").on("scroll",function(){var e;1!=DisableFixScrol&&(void 0!==ScrollTimer&&clearTimeout(ScrollTimer),DisableFixScrol=2,e=$("#fixedscroll").scrollLeft(),$(ScrollObject).scrollTo(e,{}),ScrollTimer=setTimeout(function(){DisableFixScrol=0,ScrollTimer=void 0},300))}),0<CurUser&&jQuery("#fav_img").click(function(){var e;e="on"==FavStat?(FavStat="off",0):(FavStat="on",1);var t=$("title").text();$.post("/save.php",{title:t,mode:"601",cid:e,url:RU}),jQuery(this).attr("src","//grandgames.net/img/fav_"+FavStat+".png")}),$(document).on("click",".show_spoiler",function(e){var t=jQuery(this).attr("abbr");jQuery(this).hide(),jQuery("#"+t).show("slow")}),jQuery(document).on("mousemove",".tagsarea",function(e){TagPosX=e.pageX,TagPosY=e.pageY}),$(document).on("keyup",".tagsarea",function(e){var t=$(this).val();if(AjaxTagInput=this,t!=LastTagText)if($("#ajaxtags").hide(),""==LastTagText)LastTagText=t;else{for(var o=0,a=t.length;LastTagText.charAt(o)==t.charAt(o)&&""!=t.charAt(o)&&""!=LastTagText.charAt(o);)o++;LastTagText=t;for(var n=o;"#"!=t.charAt(n)&&0<n;)n--;for(var r=o;/[а-яА-ЯёЁ\w]/.test(t.charAt(r))&&r<a;)r++;var c,i=t.substring(n,r);"#"==i.charAt(0)&&2<i.length&&(void 0===(c=$("#tagplaceid").val())&&(c=0),$.post("//grandgames.net/actions.php",{mode:"getpuzzletags",tag:i,place:c},function(e){""!=e&&($("#ajaxtagslist").html(e),$("#ajaxtags").css("left",TagPosX),$("#ajaxtags").css("top",TagPosY+25),$("#ajaxtags").show(),NowTagText=t,NowTagTextStart=n,NowTagTextEnd=r)}))}}),SetHandsAction(),MLoadTrends(),setTimeout(function(){CheckFreeSpace()},500),$("#agtimer").length&&setInterval(function(){var e,t;!GameTimerStop&&IsGameStarted&&(t=new Date,GameTimer=t-StartGameTime+1e3*GameTimerAdd,e=Math.round(GameTimer/1e3),(t=Math.floor(e/60))<10&&(t="0"+t),(e%=60)<10&&(e="0"+e),$("#agtimer").html(t+":"+e))},500),jQuery("a.disabvip").click(function(){return LGAlert("onlyvip"),!1}),jQuery("#fav_img").on("mouseover",function(){jQuery(this).attr("src","//grandgames.net/img/fav_hl.png")}),jQuery("#fav_img").on("mouseleave",function(){jQuery(this).attr("src","//grandgames.net/img/fav_"+FavStat+".png")}),$(window).scroll(function(){var e=$(document).scrollTop();scrollButtonLim<=e&&!isVivibleScrollButton?(isVivibleScrollButton=!0,$("#scrollupbut").show()):e<scrollButtonLim&&(isVivibleScrollButton=!1,$("#scrollupbut").hide())})});var imageUrl="//grandgames.net/img/color.png";function vibrate(e){try{"vibrate"in navigator&&window.navigator.vibrate(e)}catch(e){}}this.iColorPicker=function(){jQuery("input.iColorPicker").each(function(e){0==e&&(jQuery(document.createElement("div")).attr("id","iColorPicker").css("display","none").html('<table class="pickerTable" id="pickerTable0"><thead id="hexSection0"><tr><td style="background:#f00;" hx="f00"></td><td style="background:#ff0" hx="ff0"></td><td style="background:#0f0" hx="0f0"></td><td style="background:#0ff" hx="0ff"></td><td style="background:#00f" hx="00f"></td><td style="background:#f0f" hx="f0f"></td><td style="background:#fff" hx="fff"></td><td style="background:#ebebeb" hx="ebebeb"></td><td style="background:#e1e1e1" hx="e1e1e1"></td><td style="background:#d7d7d7" hx="d7d7d7"></td><td style="background:#cccccc" hx="cccccc"></td><td style="background:#c2c2c2" hx="c2c2c2"></td><td style="background:#b7b7b7" hx="b7b7b7"></td><td style="background:#acacac" hx="acacac"></td><td style="background:#a0a0a0" hx="a0a0a0"></td><td style="background:#959595" hx="959595"></td></tr><tr><td style="background:#ee1d24" hx="ee1d24"></td><td style="background:#fff100" hx="fff100"></td><td style="background:#00a650" hx="00a650"></td><td style="background:#00aeef" hx="00aeef"></td><td style="background:#2f3192" hx="2f3192"></td><td style="background:#ed008c" hx="ed008c"></td><td style="background:#898989" hx="898989"></td><td style="background:#7d7d7d" hx="7d7d7d"></td><td style="background:#707070" hx="707070"></td><td style="background:#626262" hx="626262"></td><td style="background:#555" hx="555"></td><td style="background:#464646" hx="464646"></td><td style="background:#363636" hx="363636"></td><td style="background:#262626" hx="262626"></td><td style="background:#111" hx="111"></td><td style="background:#000" hx="000"></td></tr><tr><td style="background:#f7977a" hx="f7977a"></td><td style="background:#fbad82" hx="fbad82"></td><td style="background:#fdc68c" hx="fdc68c"></td><td style="background:#fff799" hx="fff799"></td><td style="background:#c6df9c" hx="c6df9c"></td><td style="background:#a4d49d" hx="a4d49d"></td><td style="background:#81ca9d" hx="81ca9d"></td><td style="background:#7bcdc9" hx="7bcdc9"></td><td style="background:#6ccff7" hx="6ccff7"></td><td style="background:#7ca6d8" hx="7ca6d8"></td><td style="background:#8293ca" hx="8293ca"></td><td style="background:#8881be" hx="8881be"></td><td style="background:#a286bd" hx="a286bd"></td><td style="background:#bc8cbf" hx="bc8cbf"></td><td style="background:#f49bc1" hx="f49bc1"></td><td style="background:#f5999d" hx="f5999d"></td></tr><tr><td style="background:#f16c4d" hx="f16c4d"></td><td style="background:#f68e54" hx="f68e54"></td><td style="background:#fbaf5a" hx="fbaf5a"></td><td style="background:#fff467" hx="fff467"></td><td style="background:#acd372" hx="acd372"></td><td style="background:#7dc473" hx="7dc473"></td><td style="background:#39b778" hx="39b778"></td><td style="background:#16bcb4" hx="16bcb4"></td><td style="background:#00bff3" hx="00bff3"></td><td style="background:#438ccb" hx="438ccb"></td><td style="background:#5573b7" hx="5573b7"></td><td style="background:#5e5ca7" hx="5e5ca7"></td><td style="background:#855fa8" hx="855fa8"></td><td style="background:#a763a9" hx="a763a9"></td><td style="background:#ef6ea8" hx="ef6ea8"></td><td style="background:#f16d7e" hx="f16d7e"></td></tr><tr><td style="background:#ee1d24" hx="ee1d24"></td><td style="background:#f16522" hx="f16522"></td><td style="background:#f7941d" hx="f7941d"></td><td style="background:#fff100" hx="fff100"></td><td style="background:#8fc63d" hx="8fc63d"></td><td style="background:#37b44a" hx="37b44a"></td><td style="background:#00a650" hx="00a650"></td><td style="background:#00a99e" hx="00a99e"></td><td style="background:#00aeef" hx="00aeef"></td><td style="background:#0072bc" hx="0072bc"></td><td style="background:#0054a5" hx="0054a5"></td><td style="background:#2f3192" hx="2f3192"></td><td style="background:#652c91" hx="652c91"></td><td style="background:#91278f" hx="91278f"></td><td style="background:#ed008c" hx="ed008c"></td><td style="background:#ee105a" hx="ee105a"></td></tr><tr><td style="background:#9d0a0f" hx="9d0a0f"></td><td style="background:#a1410d" hx="a1410d"></td><td style="background:#a36209" hx="a36209"></td><td style="background:#aba000" hx="aba000"></td><td style="background:#588528" hx="588528"></td><td style="background:#197b30" hx="197b30"></td><td style="background:#007236" hx="007236"></td><td style="background:#00736a" hx="00736a"></td><td style="background:#0076a4" hx="0076a4"></td><td style="background:#004a80" hx="004a80"></td><td style="background:#003370" hx="003370"></td><td style="background:#1d1363" hx="1d1363"></td><td style="background:#450e61" hx="450e61"></td><td style="background:#62055f" hx="62055f"></td><td style="background:#9e005c" hx="9e005c"></td><td style="background:#9d0039" hx="9d0039"></td></tr><tr><td style="background:#790000" hx="790000"></td><td style="background:#7b3000" hx="7b3000"></td><td style="background:#7c4900" hx="7c4900"></td><td style="background:#827a00" hx="827a00"></td><td style="background:#3e6617" hx="3e6617"></td><td style="background:#045f20" hx="045f20"></td><td style="background:#005824" hx="005824"></td><td style="background:#005951" hx="005951"></td><td style="background:#005b7e" hx="005b7e"></td><td style="background:#003562" hx="003562"></td><td style="background:#002056" hx="002056"></td><td style="background:#0c004b" hx="0c004b"></td><td style="background:#30004a" hx="30004a"></td><td style="background:#4b0048" hx="4b0048"></td><td style="background:#7a0045" hx="7a0045"></td><td style="background:#7a0026" hx="7a0026"></td></tr></thead><tbody><tr><td style="border:1px solid #000;background:#fff;cursor:pointer;height:60px;-moz-background-clip:-moz-initial;-moz-background-origin:-moz-initial;-moz-background-inline-policy:-moz-initial;" colspan="16" align="center" id="colorPreview"><span style="color:#000;border:1px solid rgb(0, 0, 0);padding:5px;background-color:#fff;font:11px Arial, Helvetica, sans-serif;"></span></td></tr></tbody></table><style>#iColorPicker input{margin:2px}</style>').appendTo("body"),jQuery(document.createElement("div")).attr("id","iColorPickerBg").click(function(){jQuery("#iColorPickerBg").hide(),jQuery("#iColorPicker").fadeOut()}).appendTo("body"),jQuery("table.pickerTable td").css({width:"12px",height:"14px",border:"1px solid #000",cursor:"pointer"}),jQuery("#iColorPicker table.pickerTable").css({"border-collapse":"collapse"}),jQuery("#iColorPicker").css({border:"1px solid #ccc",background:"#333",padding:"5px",color:"#fff","z-index":9999})),jQuery("#colorPreview").css({height:"50px"}),jQuery(this).css("backgroundColor",jQuery(this).val()).after('<a href="javascript:void(null)" id="icp_'+this.id+'" onclick="iColorShow(\''+this.id+"','icp_"+this.id+'\')"><img src="'+imageUrl+'" style="border:0;margin:0 0 5px 3px" align="absmiddle" ></a>')})},jQuery(function(){iColorPicker()}),function(c){var o={type:"html",content:"",url:"",ajax:{},ajax_request:null,closeOnEsc:!0,closeOnOverlayClick:!0,clone:!1,overlay:{block:void 0,tpl:'<div class="arcticmodal-overlay"></div>',css:{backgroundColor:"#000",opacity:.6}},container:{block:void 0,tpl:'<div class="arcticmodal-container"><table class="arcticmodal-container_i"><tr><td class="arcticmodal-container_i2"></td></tr></table></div>'},wrap:void 0,body:void 0,errors:{tpl:'<div class="arcticmodal-error arcticmodal-close"></div>',autoclose_delay:2e3,ajax_unsuccessful_load:"Error"},openEffect:{type:"fade",speed:400},closeEffect:{type:"fade",speed:400},beforeOpen:c.noop,afterOpen:c.noop,beforeClose:c.noop,afterClose:c.noop,afterLoading:c.noop,afterLoadingOnShow:c.noop,errorLoading:c.noop},i=0,d=c([]),s=function(e,t){var o=!0;return c(e).each(function(){c(t.target).get(0)==c(this).get(0)&&(o=!1),0==c(t.target).closest("HTML",c(this).get(0)).length&&(o=!1)}),o},l={getParentEl:function(e){var t=c(e);return(t.data("arcticmodal")||!!(t=c(e).closest(".arcticmodal-container").data("arcticmodalParentEl")))&&t},transition:function(e,t,o,a){switch(a=null==a?c.noop:a,o.type){case"fade":"show"==t?e.fadeIn(o.speed,a):e.fadeOut(o.speed,a);break;case"none":"show"==t?e.show():e.hide(),a()}},prepare_body:function(e,t){c(".arcticmodal-close",e.body).unbind("click.arcticmodal").bind("click.arcticmodal",function(){return t.arcticmodal("close"),!1})},init_el:function(t,e){var o,a,n,r=t.data("arcticmodal");if(!r){if(i++,(r=e).modalID=i,r.overlay.block=c(r.overlay.tpl),r.overlay.block.css(r.overlay.css),r.container.block=c(r.container.tpl),r.body=c(".arcticmodal-container_i2",r.container.block),e.clone?r.body.html(t.clone(!0)):(t.before('<div id="arcticmodalReserve'+r.modalID+'" style="display: none" />'),r.body.html(t)),l.prepare_body(r,t),r.closeOnOverlayClick&&r.overlay.block.add(r.container.block).click(function(e){s(c(">*",r.body),e)&&t.arcticmodal("close")}),r.container.block.data("arcticmodalParentEl",t),t.data("arcticmodal",r),d=c.merge(d,t),c.proxy(u.show,t)(),"html"==r.type)return t;null!=r.ajax.beforeSend&&(o=r.ajax.beforeSend,delete r.ajax.beforeSend),null!=r.ajax.success&&(a=r.ajax.success,delete r.ajax.success),null!=r.ajax.error&&(n=r.ajax.error,delete r.ajax.error);e=c.extend(!0,{url:r.url,beforeSend:function(){null==o?r.body.html('<div class="arcticmodal-loading" />'):o(r,t)},success:function(e){t.trigger("afterLoading"),r.afterLoading(r,t,e),null==a?r.body.html(e):a(r,t,e),l.prepare_body(r,t),t.trigger("afterLoadingOnShow"),r.afterLoadingOnShow(r,t,e)},error:function(){t.trigger("errorLoading"),r.errorLoading(r,t),null==n?(r.body.html(r.errors.tpl),c(".arcticmodal-error",r.body).html(r.errors.ajax_unsuccessful_load),c(".arcticmodal-close",r.body).click(function(){return t.arcticmodal("close"),!1}),r.errors.autoclose_delay&&setTimeout(function(){t.arcticmodal("close")},r.errors.autoclose_delay)):n(r,t)}},r.ajax);r.ajax_request=c.ajax(e),t.data("arcticmodal",r)}},init:function(e){if(e=c.extend(!0,{},o,e),!c.isFunction(this))return this.each(function(){l.init_el(c(this),c.extend(!0,{},e))});if(null==e)c.error("jquery.arcticmodal: Uncorrect parameters");else if(""==e.type)c.error('jquery.arcticmodal: Don\'t set parameter "type"');else switch(e.type){case"html":if(""==e.content){c.error('jquery.arcticmodal: Don\'t set parameter "content"');break}var t=e.content;return e.content="",l.init_el(c(t),e);case"ajax":if(""!=e.url)return l.init_el(c("<div />"),e);c.error('jquery.arcticmodal: Don\'t set parameter "url"')}}},u={show:function(){var e=l.getParentEl(this);if(!1!==e){var t=e.data("arcticmodal");t.overlay.block.hide(),t.container.block.hide();var o,a=$("#all");return c(a).append(t.overlay.block),c(a).append(t.container.block),t.beforeOpen(t,e),e.trigger("beforeOpen"),"hidden"!=t.wrap.css("overflow")&&(t.wrap.data("arcticmodalOverflow",t.wrap.css("overflow")),o=t.wrap.outerWidth(!0),t.wrap.css("overflow","hidden"),(a=t.wrap.outerWidth(!0))!=o&&t.wrap.css("marginRight",a-o+"px")),d.not(e).each(function(){c(this).data("arcticmodal").overlay.block.hide()}),l.transition(t.overlay.block,"show",1<d.length?{type:"none"}:t.openEffect),l.transition(t.container.block,"show",1<d.length?{type:"none"}:t.openEffect,function(){t.afterOpen(t,e),e.trigger("afterOpen")}),e}c.error("jquery.arcticmodal: Uncorrect call")},close:function(){if(!c.isFunction(this))return this.each(function(){var e,t=l.getParentEl(this);!1===t?c.error("jquery.arcticmodal: Uncorrect call"):!1!==(e=t.data("arcticmodal")).beforeClose(e,t)&&(t.trigger("beforeClose"),d.not(t).last().each(function(){c(this).data("arcticmodal").overlay.block.show()}),l.transition(e.overlay.block,"hide",1<d.length?{type:"none"}:e.closeEffect),l.transition(e.container.block,"hide",1<d.length?{type:"none"}:e.closeEffect,function(){e.afterClose(e,t),t.trigger("afterClose"),e.clone||c("#arcticmodalReserve"+e.modalID).replaceWith(e.body.find(">*")),e.overlay.block.remove(),e.container.block.remove(),t.data("arcticmodal",null),c(".arcticmodal-container").length||(e.wrap.data("arcticmodalOverflow")&&e.wrap.css("overflow",e.wrap.data("arcticmodalOverflow")),e.wrap.css("marginRight",0))}),"ajax"==e.type&&e.ajax_request.abort(),d=d.not(t))});d.each(function(){c(this).arcticmodal("close")})},setDefault:function(e){c.extend(!0,o,e)}};c(function(){o.wrap=c(document.all&&!document.querySelector?"html":"body")}),c(document).bind("keyup.arcticmodal",function(e){var t=d.last();t.length&&t.data("arcticmodal").closeOnEsc&&27===e.keyCode&&t.arcticmodal("close")}),c.arcticmodal=c.fn.arcticmodal=function(e){return u[e]?u[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void c.error("jquery.arcticmodal: Method "+e+" does not exist"):l.init.apply(this,arguments)}}(jQuery),0<UIND&&(WSConnect(),WSBind("ws_usermes"+UIND,"PushWindow"),void 0!==chatPlace&&chatEnter());